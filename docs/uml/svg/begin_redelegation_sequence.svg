<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1599" height="958" contentScriptType="application/ecmascript" contentStyleType="text/css" preserveAspectRatio="none" style="width:1599px;height:958px" version="1.1" viewBox="0 0 1599 958" zoomAndPan="magnify"><defs><filter id="f1w2okko18ktw4" width="300%" height="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text x="737.75" y="28.708" fill="#000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="120">Redelegation</text><rect width="562.5" height="46.266" x="467" y="244.781" fill="#FFF" filter="url(#f1w2okko18ktw4)" style="stroke:#000;stroke-width:2"/><rect width="562.5" height="46.266" x="467" y="305.047" fill="#FFF" filter="url(#f1w2okko18ktw4)" style="stroke:#000;stroke-width:2"/><rect width="1020.5" height="71.398" x="9" y="365.313" fill="#FFF" filter="url(#f1w2okko18ktw4)" style="stroke:#000;stroke-width:2"/><rect width="562.5" height="46.266" x="467" y="520.844" fill="#FFF" filter="url(#f1w2okko18ktw4)" style="stroke:#000;stroke-width:2"/><rect width="562.5" height="46.266" x="467" y="651.242" fill="#FFF" filter="url(#f1w2okko18ktw4)" style="stroke:#000;stroke-width:2"/><rect width="646" height="75.398" x="939.5" y="711.508" fill="#FFF" filter="url(#f1w2okko18ktw4)" style="stroke:#000;stroke-width:2"/><line style="stroke:#a80036;stroke-width:1" x1="524" x2="524" y1="102.25" y2="485.844"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:1,4" x1="524" x2="524" y1="485.844" y2="513.844"/><line style="stroke:#a80036;stroke-width:1" x1="524" x2="524" y1="513.844" y2="616.242"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:1,4" x1="524" x2="524" y1="616.242" y2="644.242"/><line style="stroke:#a80036;stroke-width:1" x1="524" x2="524" y1="644.242" y2="890.305"/><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="984.5" y1="102.25" y2="485.844"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:1,4" x1="984.5" x2="984.5" y1="485.844" y2="513.844"/><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="984.5" y1="513.844" y2="616.242"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:1,4" x1="984.5" x2="984.5" y1="616.242" y2="644.242"/><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="984.5" y1="644.242" y2="890.305"/><line style="stroke:#a80036;stroke-width:1" x1="1553.5" x2="1553.5" y1="102.25" y2="485.844"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:1,4" x1="1553.5" x2="1553.5" y1="485.844" y2="513.844"/><line style="stroke:#a80036;stroke-width:1" x1="1553.5" x2="1553.5" y1="513.844" y2="616.242"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:1,4" x1="1553.5" x2="1553.5" y1="616.242" y2="644.242"/><line style="stroke:#a80036;stroke-width:1" x1="1553.5" x2="1553.5" y1="644.242" y2="890.305"/><rect width="91" height="30.297" x="477" y="66.953" fill="#FEFECE" filter="url(#f1w2okko18ktw4)" style="stroke:#a80036;stroke-width:1.5"/><text x="484" y="86.948" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77">msgServer</text><rect width="91" height="30.297" x="477" y="889.305" fill="#FEFECE" filter="url(#f1w2okko18ktw4)" style="stroke:#a80036;stroke-width:1.5"/><text x="484" y="909.3" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77">msgServer</text><rect width="66" height="30.297" x="949.5" y="66.953" fill="#FEFECE" filter="url(#f1w2okko18ktw4)" style="stroke:#a80036;stroke-width:1.5"/><text x="956.5" y="86.948" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52">keeper</text><rect width="66" height="30.297" x="949.5" y="889.305" fill="#FEFECE" filter="url(#f1w2okko18ktw4)" style="stroke:#a80036;stroke-width:1.5"/><text x="956.5" y="909.3" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52">keeper</text><text x="1531.5" y="98.948" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38">store</text><path fill="#FEFECE" d="M1535.5,49.9531 C1535.5,39.9531 1553.5,39.9531 1553.5,39.9531 C1553.5,39.9531 1571.5,39.9531 1571.5,49.9531 L1571.5,75.9531 C1571.5,85.9531 1553.5,85.9531 1553.5,85.9531 C1553.5,85.9531 1535.5,85.9531 1535.5,75.9531 L1535.5,49.9531" filter="url(#f1w2okko18ktw4)" style="stroke:#000;stroke-width:1.5"/><path fill="none" d="M1535.5,49.9531 C1535.5,59.9531 1553.5,59.9531 1553.5,59.9531 C1553.5,59.9531 1571.5,59.9531 1571.5,49.9531" style="stroke:#000;stroke-width:1.5"/><text x="1531.5" y="902.3" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38">store</text><path fill="#FEFECE" d="M1535.5,915.6016 C1535.5,905.6016 1553.5,905.6016 1553.5,905.6016 C1553.5,905.6016 1571.5,905.6016 1571.5,915.6016 L1571.5,941.6016 C1571.5,951.6016 1553.5,951.6016 1553.5,951.6016 C1553.5,951.6016 1535.5,951.6016 1535.5,941.6016 L1535.5,915.6016" filter="url(#f1w2okko18ktw4)" style="stroke:#000;stroke-width:1.5"/><path fill="none" d="M1535.5,915.6016 C1535.5,925.6016 1553.5,925.6016 1553.5,925.6016 C1553.5,925.6016 1571.5,925.6016 1571.5,915.6016" style="stroke:#000;stroke-width:1.5"/><polygon fill="#A80036" points="972.5 129.383 982.5 133.383 972.5 137.383 976.5 133.383" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="524.5" x2="978.5" y1="133.383" y2="133.383"/><text x="531.5" y="128.317" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="436">BeginRedelegation(delAddr, valSrcAddr, valDstAddr, sharesAmount)</text><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="1026.5" y1="168.582" y2="168.582"/><line style="stroke:#a80036;stroke-width:1" x1="1026.5" x2="1026.5" y1="168.582" y2="181.582"/><line style="stroke:#a80036;stroke-width:1" x1="985.5" x2="1026.5" y1="181.582" y2="181.582"/><polygon fill="#A80036" points="995.5 177.582 985.5 181.582 995.5 185.582 991.5 181.582" style="stroke:#a80036;stroke-width:1"/><text x="991.5" y="163.516" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143">get number of sharew</text><path fill="#FBFB77" d="M494,146.3828 L494,186.3828 L975,186.3828 L975,156.3828 L965,146.3828 L494,146.3828" filter="url(#f1w2okko18ktw4)" style="stroke:#a80036;stroke-width:1"/><path fill="#FBFB77" d="M965,146.3828 L965,156.3828 L975,156.3828 L965,146.3828" style="stroke:#a80036;stroke-width:1"/><text x="500" y="163.45" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="448">If the delegator has more shares than the total shares in the validator</text><text x="500" y="178.583" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="460">(due to rounding errors), then just withdraw the max number of shares.</text><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="1026.5" y1="216.781" y2="216.781"/><line style="stroke:#a80036;stroke-width:1" x1="1026.5" x2="1026.5" y1="216.781" y2="229.781"/><line style="stroke:#a80036;stroke-width:1" x1="985.5" x2="1026.5" y1="229.781" y2="229.781"/><polygon fill="#A80036" points="995.5 225.781 985.5 229.781 995.5 233.781 991.5 229.781" style="stroke:#a80036;stroke-width:1"/><text x="991.5" y="211.715" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278">check the redelegation uses correct denom</text><path fill="#EEE" d="M467,244.7813 L533,244.7813 L533,251.7813 L523,261.7813 L467,261.7813 L467,244.7813" style="stroke:#000;stroke-width:1"/><rect width="562.5" height="46.266" x="467" fill="none" style="stroke:#000;stroke-width:2" y="244.781"/><text x="482" y="257.848" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21">alt</text><text x="548" y="256.992" fill="#000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="180">[valSrcAddr == valDstAddr]</text><polygon fill="#A80036" points="535.5 279.047 525.5 283.047 535.5 287.047 531.5 283.047" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="529.5" x2="983.5" y1="283.047" y2="283.047"/><text x="541.5" y="277.981" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31">error</text><path fill="#EEE" d="M467,305.0469 L533,305.0469 L533,312.0469 L523,322.0469 L467,322.0469 L467,305.0469" style="stroke:#000;stroke-width:1"/><rect width="562.5" height="46.266" x="467" fill="none" style="stroke:#000;stroke-width:2" y="305.047"/><text x="482" y="318.114" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21">alt</text><text x="548" y="317.257" fill="#000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="166">[transitive redelegation]</text><polygon fill="#A80036" points="535.5 339.313 525.5 343.313 535.5 347.313 531.5 343.313" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="529.5" x2="983.5" y1="343.313" y2="343.313"/><text x="541.5" y="338.247" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31">error</text><path fill="#EEE" d="M9,365.3125 L75,365.3125 L75,372.3125 L65,382.3125 L9,382.3125 L9,365.3125" style="stroke:#000;stroke-width:1"/><rect width="1020.5" height="71.398" x="9" fill="none" style="stroke:#000;stroke-width:2" y="365.313"/><text x="24" y="378.379" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21">alt</text><text x="90" y="377.523" fill="#000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="214">[already has max redelegations]</text><polygon fill="#A80036" points="535.5 412.144 525.5 416.144 535.5 420.144 531.5 416.144" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="529.5" x2="983.5" y1="416.144" y2="416.144"/><text x="541.5" y="411.079" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31">error</text><path fill="#FBFB77" d="M19,387.4453 L19,427.4453 L515,427.4453 L515,397.4453 L505,387.4453 L19,387.4453" filter="url(#f1w2okko18ktw4)" style="stroke:#a80036;stroke-width:1"/><path fill="#FBFB77" d="M505,387.4453 L505,397.4453 L515,397.4453 L505,387.4453" style="stroke:#a80036;stroke-width:1"/><text x="25" y="404.512" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="475">this is the number of redelegations for a specific (del, valSrc, valDst) triple</text><text x="25" y="419.645" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66">default : 7</text><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="1026.5" y1="464.844" y2="464.844"/><line style="stroke:#a80036;stroke-width:1" x1="1026.5" x2="1026.5" y1="464.844" y2="477.844"/><line style="stroke:#a80036;stroke-width:1" x1="985.5" x2="1026.5" y1="477.844" y2="477.844"/><polygon fill="#A80036" points="995.5 473.844 985.5 477.844 995.5 481.844 991.5 477.844" style="stroke:#a80036;stroke-width:1"/><text x="991.5" y="459.778" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269">Unbond(del, valSrc) returns returnAmount</text><path fill="#FBFB77" d="M802,450.2109 L802,475.2109 L975,475.2109 L975,460.2109 L965,450.2109 L802,450.2109" filter="url(#f1w2okko18ktw4)" style="stroke:#a80036;stroke-width:1"/><path fill="#FBFB77" d="M965,450.2109 L965,460.2109 L975,460.2109 L965,450.2109" style="stroke:#a80036;stroke-width:1"/><text x="808" y="467.278" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152">See unbonding diagram</text><path fill="#EEE" d="M467,520.8438 L533,520.8438 L533,527.8438 L523,537.8438 L467,537.8438 L467,520.8438" style="stroke:#000;stroke-width:1"/><rect width="562.5" height="46.266" x="467" fill="none" style="stroke:#000;stroke-width:2" y="520.844"/><text x="482" y="533.911" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21">alt</text><text x="548" y="533.054" fill="#000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155">[returnAmount is zero]</text><polygon fill="#A80036" points="535.5 555.109 525.5 559.109 535.5 563.109 531.5 559.109" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="529.5" x2="983.5" y1="559.109" y2="559.109"/><text x="541.5" y="554.043" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31">error</text><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="1026.5" y1="595.242" y2="595.242"/><line style="stroke:#a80036;stroke-width:1" x1="1026.5" x2="1026.5" y1="595.242" y2="608.242"/><line style="stroke:#a80036;stroke-width:1" x1="985.5" x2="1026.5" y1="608.242" y2="608.242"/><polygon fill="#A80036" points="995.5 604.242 985.5 608.242 995.5 612.242 991.5 608.242" style="stroke:#a80036;stroke-width:1"/><text x="991.5" y="590.176" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="555">Delegate(del, returnAmount, status := valSrc.status, valDst, subtractAccount := false)</text><path fill="#FBFB77" d="M802,580.6094 L802,605.6094 L975,605.6094 L975,590.6094 L965,580.6094 L802,580.6094" filter="url(#f1w2okko18ktw4)" style="stroke:#a80036;stroke-width:1"/><path fill="#FBFB77" d="M965,580.6094 L965,590.6094 L975,590.6094 L965,580.6094" style="stroke:#a80036;stroke-width:1"/><text x="808" y="597.676" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152">See delegation diagram</text><path fill="#EEE" d="M467,651.2422 L533,651.2422 L533,658.2422 L523,668.2422 L467,668.2422 L467,651.2422" style="stroke:#000;stroke-width:1"/><rect width="562.5" height="46.266" x="467" fill="none" style="stroke:#000;stroke-width:2" y="651.242"/><text x="482" y="664.309" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21">alt</text><text x="548" y="663.453" fill="#000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="155">[validator is unbonded]</text><polygon fill="#A80036" points="535.5 685.508 525.5 689.508 535.5 693.508 531.5 689.508" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="529.5" x2="983.5" y1="689.508" y2="689.508"/><text x="541.5" y="684.442" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79">current time</text><path fill="#EEE" d="M939.5,711.5078 L1005.5,711.5078 L1005.5,718.5078 L995.5,728.5078 L939.5,728.5078 L939.5,711.5078" style="stroke:#000;stroke-width:1"/><rect width="646" height="75.398" x="939.5" fill="none" style="stroke:#000;stroke-width:2" y="711.508"/><text x="954.5" y="724.575" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21">alt</text><text x="1020.5" y="723.718" fill="#000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="282">[unbonding not complete, or just started]</text><polygon fill="#A80036" points="1541.5 745.773 1551.5 749.773 1541.5 753.773 1545.5 749.773" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="1547.5" y1="749.773" y2="749.773"/><text x="991.5" y="744.707" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168">create redelegation object</text><polygon fill="#A80036" points="1541.5 774.906 1551.5 778.906 1541.5 782.906 1545.5 778.906" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="984.5" x2="1547.5" y1="778.906" y2="778.906"/><text x="991.5" y="773.84" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="443">insert redelegation in queue, to be processed at the appropriate time</text><polygon fill="#A80036" points="535.5 811.039 525.5 815.039 535.5 819.039 531.5 815.039" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="529.5" x2="983.5" y1="815.039" y2="815.039"/><text x="541.5" y="809.973" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230">completion time of the redelegation</text><line style="stroke:#a80036;stroke-width:1" x1="524.5" x2="566.5" y1="859.305" y2="859.305"/><line style="stroke:#a80036;stroke-width:1" x1="566.5" x2="566.5" y1="859.305" y2="872.305"/><line style="stroke:#a80036;stroke-width:1" x1="525.5" x2="566.5" y1="872.305" y2="872.305"/><polygon fill="#A80036" points="535.5 868.305 525.5 872.305 535.5 876.305 531.5 872.305" style="stroke:#a80036;stroke-width:1"/><text x="531.5" y="839.106" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238">emit event: delegator, valSrc, valSrc,</text><text x="531.5" y="854.239" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205">sharesAmount, completionTime</text></g></svg>